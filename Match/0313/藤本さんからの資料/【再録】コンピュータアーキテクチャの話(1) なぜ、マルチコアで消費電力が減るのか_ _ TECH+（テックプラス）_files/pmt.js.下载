!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports._pmt1007486=t():e._pmt1007486=t()}(this,(function(){return function(){"use strict";var e={};function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=function(e){try{return localStorage.getItem(e)}catch(t){return null}},r=function(e,t){try{localStorage.setItem(e,t)}catch(n){}},c=function(e){try{return sessionStorage.getItem(e)}catch(t){return null}},u=function(e,t){try{sessionStorage.setItem(e,t)}catch(n){}},l=function(){function e(n){t(this,e),s(this,"sessionStorageKey","__im_uid_ses_".concat("1007486")),s(this,"defaultUidUrl","https://dmp.im-apps.net/sdk/im-uid.js"),s(this,"ttlSeconds",1800),e.userCallbackName=n?n.getAttribute("data-uid-callback"):"",e.uid=this.getUidFromLocal()}return i(e,[{key:"setUidTag",value:function(){window.IMUIDRequest=window.IMUIDRequest||[];var e=document.getElementsByTagName("script")[0],t=document.createElement("script");t.async=!0,t.src=undefined||this.defaultUidUrl,e.parentNode.insertBefore(t,e)}},{key:"getUidFromLocal",value:function(){return a(e.storageKey)}},{key:"processSdkCallback",value:function(t){r(e.storageKey,t.uid),e.setVariable(t.uid),e.processUserCallback()}},{key:"getVariable",value:function(){return e.uid}},{key:"update",value:function(){var t=(parseInt(c(this.sessionStorageKey))||0)+this.ttlSeconds<Math.floor(Date.now()/1e3);if(null===e.uid||t){var n=Math.floor(Date.now()/1e3);u(this.sessionStorageKey,n.toString()),this.setUidTag(),window.IMUIDRequest.push({customerId:"1007486",callback:this.processSdkCallback})}}}],[{key:"uid",get:function(){return e._uid},set:function(t){e._uid=t}},{key:"userCallbackName",get:function(){return e._userCallbackName},set:function(t){e._userCallbackName=t}},{key:"executedCallback",get:function(){return e._executedCallback},set:function(t){e._executedCallback=t}},{key:"setVariable",value:function(t){t&&(e.uid=t),window[e.storageKey]=e.uid}},{key:"processUserCallback",value:function(){if(null!==e.uid&&!e.executedCallback&&e.userCallbackName){var t=e.userCallbackName.split("."),n=window[t[0]];if("object"===o(n))for(var i=1;i<t.length&&"object"===o(n);i++)n=n[t[i]];"function"==typeof n&&(e.executedCallback=!0,n(e.uid))}}}]),e}();s(l,"_uid",void 0),s(l,"_userCallbackName",void 0),s(l,"_executedCallback",void 0),s(l,"storageKey","__im_uid_".concat("1007486"));var d=function(){function e(n){t(this,e),s(this,"sids",void 0),s(this,"token",void 0),s(this,"executedCallback",void 0),s(this,"userCallbackName",void 0),s(this,"baseStorageKey","__im_sids"),s(this,"storageKey","".concat(this.baseStorageKey,"_").concat("1007486")),s(this,"sessionStorageKey","".concat(this.baseStorageKey,"_ses_").concat("1007486")),s(this,"sidsUrl","https://sync6.im-apps.net/segment"),s(this,"ttlSeconds",3600),this.userCallbackName=n?n.getAttribute("data-sids-callback"):"",this.token=this.getUniq(),this.sids=this.getSeg(c("".concat(this.storageKey,"_").concat(this.token)))}return i(e,[{key:"getUniq",value:function(){var e=new Date,t=this.baseStorageKey+e.getUTCDate()%5;return btoa(t).replace(/=*$/g,"")}},{key:"getSeg",value:function(e){if(!e)return e;var t=[];try{for(var n=atob(decodeURIComponent(e)).replace(/=*$/g,""),i=0;i<n.length;i++){var s=n.charCodeAt(i)^this.token.charCodeAt(i%this.token.length);t.push(String.fromCharCode(s))}return t.join("")}catch(o){return""}}},{key:"getVariable",value:function(){return this.sids}},{key:"setVariable",value:function(e){e&&(this.sids=this.getSeg(e));var t=this.sids?this.sids.split(","):[];window[this.storageKey]=t}},{key:"processUserCallback",value:function(){if(null!==this.sids&&!this.executedCallback&&this.userCallbackName){var e=this.sids?this.sids.split(","):[],t=this.userCallbackName.split("."),n=window[t[0]];if("object"===o(n))for(var i=1;i<t.length&&"object"===o(n);i++)n=n[t[i]];"function"==typeof n&&(this.executedCallback=!0,n(e))}}},{key:"update",value:function(){var e=this,t=(parseInt(c("".concat(this.sessionStorageKey,"_").concat(this.token)))||0)+this.ttlSeconds<Math.floor(Date.now()/1e3);if(null===this.sids||t){var n=new XMLHttpRequest,i=this.token;n.open("GET","".concat(this.sidsUrl,"?token=").concat(i),!0),n.timeout=3e3,n.withCredentials=!0,n.addEventListener("load",(function(){if(4===n.readyState)if(200===n.status){var t="";try{t=JSON.parse(n.responseText).encrypted}catch(i){console.error(i)}t&&(u("".concat(e.storageKey,"_").concat(e.token),t),u("".concat(e.sessionStorageKey,"_").concat(e.token),Math.floor(Date.now()/1e3).toString()),e.setVariable(t),e.processUserCallback())}else console.error(n.statusText)})),n.addEventListener("timeout",(function(){console.error("request for ".concat(e.sidsUrl," timed out."))})),n.addEventListener("error",(function(){console.error(n.statusText)})),n.send(null)}}}]),e}();function f(e,t){return(f=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function h(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=p(e);if(t){var s=p(this).constructor;n=Reflect.construct(i,arguments,s)}else n=i.apply(this,arguments);return h(this,n)}}var m=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&f(e,t)}(i,e);var n=g(i);function i(e){var s;return t(this,i),(s=n.call(this,e)).audienceType="1007486",s.audienceUrl="https://open.im-apps.net/evaluate?model=1007486",s.mappings={10078429:"k1GmByvg",10078428:"gdwP3jDb",10078427:"gAa7xyKg"},s}return i}(function(){function e(n){t(this,e),s(this,"userCallbackName",void 0),s(this,"executedCallback",void 0),s(this,"lessIdInfoSegment","gqw69LLk"),s(this,"errorSegment","8Nqlxweg"),s(this,"timeoutSegment","g4OxP7Gb"),s(this,"ttlSeconds",14400),s(this,"errorTtlSeconds",60),s(this,"timeoutTtlSeconds",300),s(this,"storageKey","__im_audience_".concat("1007486")),s(this,"sessionStorageKey","__im_audience_ses_".concat("1007486")),s(this,"audience",void 0),s(this,"audienceType",""),s(this,"audienceUrl",""),s(this,"mappings",{}),this.audience=this.getAudienceFromLocal(),this.userCallbackName=n?n.getAttribute("data-audience-callback"):""}return i(e,[{key:"getAudienceFromLocal",value:function(){return a(this.storageKey)}},{key:"getPreferResult",value:function(e){return e?this.mappings[e]:this.lessIdInfoSegment}},{key:"sendBeacon",value:function(e,t){var n="ml-".concat(this.audienceType),i=new Image,s=i.style;s.display="none",s.position="absolute",i.loading="eager",i.referrerPolicy="no-referrer-when-downgrade",i.src="https://b6.im-apps.net/".concat("1007486","/").concat(n,"/").concat(e,"/").concat(t),window.document.body.appendChild(i)}},{key:"setVariable",value:function(e){e&&(this.audience=e),window[this.storageKey]=this.audience}},{key:"processUserCallback",value:function(){if(null!==this.audience&&!this.executedCallback&&this.userCallbackName){var e=this.userCallbackName.split("."),t=window[e[0]];if("object"===o(t))for(var n=1;n<e.length&&"object"===o(t);n++)t=t[e[n]];"function"==typeof t&&(this.executedCallback=!0,t(this.audience))}}},{key:"update",value:function(){var e=this,t=this.ttlSeconds;this.audience===this.errorSegment?t=this.errorTtlSeconds:this.audience===this.timeoutSegment&&(t=this.timeoutTtlSeconds);var n=(parseInt(c(this.sessionStorageKey))||0)+t<Math.floor(Date.now()/1e3);if(null===this.audience||n){var i=new XMLHttpRequest;i.addEventListener("load",(function(){if(200===i.status)try{var t=JSON.parse(i.response),n=t.result.predictions[0].scores;if("done"===t.status){var s=t.result.predictions[0].classes[n.indexOf(Math.max.apply(null,n))],o="";if(t.content||"demogra"!==e.audienceType?s&&e.mappings[s]&&(o=e.mappings[s]):o=e.getPreferResult(t.prefer),o)return r(e.storageKey,o),u(e.sessionStorageKey,Math.floor(Date.now()/1e3).toString()),e.setVariable(o),undefined,"demogra"===e.audienceType&&e.sendBeacon(o,encodeURIComponent("content_".concat(t.content))),void e.processUserCallback()}}catch(a){}else r(e.storageKey,e.errorSegment),u(e.sessionStorageKey,Math.floor(Date.now()/1e3).toString()),e.setVariable(e.errorSegment),"demogra"===e.audienceType&&e.sendBeacon(e.errorSegment),e.processUserCallback()})),i.addEventListener("timeout",(function(){r(e.storageKey,e.timeoutSegment),u(e.sessionStorageKey,Math.floor(Date.now()/1e3).toString()),e.setVariable(e.timeoutSegment),"demogra"===e.audienceType&&e.sendBeacon(e.timeoutSegment),e.processUserCallback()})),i.addEventListener("error",(function(){r(e.storageKey,e.errorSegment),u(e.sessionStorageKey,Math.floor(Date.now()/1e3).toString()),e.setVariable(e.errorSegment),"demogra"===e.audienceType&&e.sendBeacon(e.errorSegment),e.processUserCallback()})),i.open("GET",this.audienceUrl,!0),i.withCredentials=!0,i.timeout=5e4,i.send()}}}]),e}());function b(e,t){window.googletag.cmd.push((function(){window.googletag.pubads().setTargeting(e,t)}))}var y=function(){function e(){t(this,e),s(this,"uid",void 0),s(this,"sids",void 0),s(this,"audience",void 0),s(this,"imPmtScriptElement",document.querySelector("script#imCid1007486")||document.querySelector("script#imPmt1007486")),this.uid=new l(this.imPmtScriptElement),this.sids=new d(this.imPmtScriptElement),this.audience=new m(this.imPmtScriptElement)}return i(e,[{key:"setupVariables",value:function(){l.setVariable(),l.processUserCallback(),this.sids.setVariable(),this.sids.processUserCallback(),this.audience.setVariable(),this.audience.processUserCallback()}},{key:"pushGPTs",value:function(){window.googletag=window.googletag||{cmd:[]},b("im_segments",this.sids.getVariable()?this.sids.getVariable().split(","):[]),b("im_audience",this.audience.audience)}},{key:"pushPrebid",value:function(){window.pbjs=window.pbjs||{},window.pbjs.que=window.pbjs.que||[];var e={};e.im_segments=this.sids.getVariable()?this.sids.getVariable().split(","):[],e.im_audience=this.audience.audience,function(e){window.pbjs.que.push((function(){window.pbjs.setConfig({ortb2:{user:{ext:{data:e}}}})}))}(e),function(e,t){switch(e){case"adfjs":window.adfjs=window.adfjs||{que:[]},window.adfjs.que=window.adfjs.que||[],window.adfjs.que.push((function(){window.adfjs.setConfig({ortb2:{user:{ext:{data:t}}}})}))}}("adfjs",e),undefined&&function(e,t){window.pbjs.que.push((function(){window.pbjs.setBidderConfig({bidders:e,config:{ortb2:{user:{ext:{data:t}}}}})}))}(undefined.split(","),e)}},{key:"initTagManager",value:function(){var e={cid:"1007486"};e.uid=l.uid,e.sids=this.sids.getVariable(),e.aud=this.audience.audience}},{key:"updateVariables",value:function(){this.uid.update(),this.sids.update(),this.audience.update()}},{key:"run",value:function(){this.setupVariables(),this.pushGPTs(),this.pushPrebid(),this.updateVariables()}}]),e}();return window.__pmt_1007486="__pmt_1007486"in window?window.__pmt_1007486:new y,window.__pmt_1007486.run(),e=e._pmt1007486}()}));